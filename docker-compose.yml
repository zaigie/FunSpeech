services:
  funspeech:
    image: docker.cnb.cool/nexa/funspeech:latest
    container_name: funspeech
    ports:
      - "8000:8000"
    volumes:
      # 模型缓存目录（ModelScope默认缓存路径）
      - ~/.cache/modelscope:/root/.cache/modelscope
      # 临时文件目录（ASR和TTS共用）
      - ./temp:/app/temp
      # 数据持久化目录（数据库等）
      - ./data:/app/data
      # 日志目录
      - ./logs:/app/logs
      # 零样本音色文件目录（用户数据）
      - ./voices:/app/voices
    environment:
      # 服务器配置
      - DEBUG=false
      - LOG_LEVEL=INFO
      - DEVICE=auto
      - TTS_DEVICE=auto
      # TTS 模型按需加载配置（可选，默认为 all）
      # - TTS_MODEL_MODE=all          # 加载所有模型（默认）
      # - TTS_MODEL_MODE=cosyvoice1   # 仅加载SFT模型，用于预设音色
      # - TTS_MODEL_MODE=cosyvoice2   # 仅加载零样本克隆模型，用于音色克隆
      # 鉴权配置（可选，不设置则鉴权为可选）
      # - APPTOKEN=your_secret_token
      # - APPKEY=your_app_key
    restart: unless-stopped
    
    # GPU支持（如果需要，取消注释以下配置并将image替换为docker.cnb.cool/nexa/funspeech:gpu-latest）
    # deploy:
    #   resources:
    #     reservations:
    #       devices:
    #         - driver: nvidia
    #           count: all
    #           capabilities: [gpu]